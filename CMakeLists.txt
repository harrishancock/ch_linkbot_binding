cmake_minimum_required(VERSION 3.2.1) 
project(liblinkbot VERSION 1.0.9 LANGUAGES C CXX)

if(CMAKE_CROSSCOMPILING)
    find_library(PTHREAD pthread ${CMAKE_PREFIX_PATH} REQUIRED)
    #set(Boost_COMPILER -gcc)
    #add_compile_options(${CMAKE_CROSSCOMPILE_C_FLAGS})
    set(CMAKE_EXE_LINKER_FLAGS "${CMAKE_CROSSCOMPILE_C_FLAGS} -static-libstdc++ -static-libgcc")
endif(CMAKE_CROSSCOMPILING)

add_subdirectory(sdk)
add_subdirectory(src)
add_subdirectory(test)

install(DIRECTORY chbarobo DESTINATION . PATTERN ".gitkeep" EXCLUDE)
if(CMAKE_SIZEOF_VOID_P EQUAL 4)
    install(DIRECTORY dlls/win32/ DESTINATION chbarobo/bin)
    install(DIRECTORY dlls/Microsoft.VC80.CRT DESTINATION chbarobo/dl)
else()
    install(DIRECTORY dlls/win64/ DESTINATION chbarobo/bin)
endif()